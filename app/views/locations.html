<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
		<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=places&key=AIzaSyDU-Lz0TW46Hza0E1gMv8weHy1gM9hKrjY"> 
		</script>


	
		<script>
			var map;
			var infowindow;
			var request;
			var request1;
			var request2;
			var service;
			var markers = [];

			var libraryImage = new google.maps.MarkerImage("https://www.shareicon.net/data/32x32/2015/11/03/666185_library_512x512.png" ); 
			var coffeeImage = new google.maps.MarkerImage("https://cdn2.iconfinder.com/data/icons/map-pins-1-01-easylines/128/yumminky-pin-13-32.png");
			var starbucksImage = new google.maps.MarkerImage("https://www.shareicon.net/data/32x32/2015/09/01/94011_starbucks_512x512.png");
			//http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2| // just black
			//https://image.flaticon.com/icons/png/512/8/8145.png //good logo too big
			//https://www.shareicon.net/data/32x32/2015/11/03/666185_library_512x512.png
			// got it at https://www.shareicon.net/map-sign-locator-location-placeholder-marker-library-libraries-maps-and-flags-maps-666185
			// coffee at https://www.iconfinder.com/icons/2090605/coffee_coffee_shop_cup_marker_pin_tea_house_yumminky_icon#size=32

			function initialize() {
				var center = new google.maps.LatLng(49.2624424, -122.9172366);
				map = new google.maps.Map(document.getElementById('map'),{
					center: center,
					zoom: 12
				});

				/*---------------------------Adding a single Marker--------------------------------------
				var starbucks = new google.maps.LatLng(49.281246, -123.0741775);
				var mkr = new google.maps.Marker({
					position: starbucks,
					map: map,
					title: "Starbucks" 
				});
				mkr.setMap(map); 
				//------------------------------------------------------------------------------------ */

				 request = {
					location:center,
					radius:10110,
					types: ['library']
				}; 
 
				 request1 = {
					location:center,
					radius:12000,
					types: ['cafe'],
					keyword: ['Starbucks']
				};

				 request2 = {
					location:center,
					radius:12000,
					types: ['cafe'],
					keyword: ['Tim Hortons']
				};

				//isLibrary = Boolean(true);


				infowindow = new google.maps.InfoWindow();

				service = new google.maps.places.PlacesService(map);

				service.nearbySearch(request,callback);
				service.nearbySearch(request1,callback1);
				service.nearbySearch(request2,callback2);
				
				google.maps.event.addListener(map, 'dblclick', function(event) {
					map.setCenter(event.latLng)
					clearResults(markers)

				 var request = {
					location: event.latLng,
					radius:5000,
					types: ['library']
				}; 
 
				 var request1 = {
					location: event.latLng,
					radius:5000,
					types: ['cafe'],
					keyword: ['Starbucks']
				};

				 var request2 = {
					location: event.latLng,
					radius:5000,
					types: ['cafe'],
					keyword: ['Tim Hortons']
				};

				service.nearbySearch(request,callback);
				service.nearbySearch(request1,callback1);
				service.nearbySearch(request2,callback2);

					})
				}			
			

			function callback(results, status) {
				if(status == google.maps.places.PlacesServiceStatus.OK){
					for(var i=0;i <results.length; i++){
						markers.push(createMarker(results[i])); //use results to call createMarker
						}
				}
			}

			function callback1(results, status) {
				if(status == google.maps.places.PlacesServiceStatus.OK){ 
					for(var i=0;i <results.length; i++){
						markers.push(createMarker1(results[i])); //use results to call createMarker
						}
				}
			}
			function callback2(results, status) {
				if(status == google.maps.places.PlacesServiceStatus.OK){ 
					for(var i=0;i <results.length; i++){
						markers.push(createMarker2(results[i])); //use results to call createMarker
						}
				}
			}			

			function createMarker(place) {
				var placeLoc = place.geometry.location;
				var marker = new google.maps.Marker({
					map:map,
					animation: google.maps.Animation.DROP,
					icon: libraryImage,
					position: place.geometry.location
				}); 
				google.maps.event.addListener(marker, 'click',function() { // waits for a click, then shows content
					infowindow.setContent(place.name);
					infowindow.open(map,this);

				});
				return marker;
			}

				function createMarker1(place) {
				var placeLoc = place.geometry.location;
				
				var marker = new google.maps.Marker({
					map:map,
					animation: google.maps.Animation.DROP,
					icon: starbucksImage,
					position: place.geometry.location
				}); 
				google.maps.event.addListener(marker, 'click',function() { // waits for a click, then shows content
					infowindow.setContent(place.name);
					infowindow.open(map,this);

				});
				return marker;
			}
				function createMarker2(place) {
				var placeLoc = place.geometry.location;
				
				var marker = new google.maps.Marker({
					map:map,
					animation: google.maps.Animation.DROP,
					//icon: coffeeImage,
					position: place.geometry.location
				}); 
				google.maps.event.addListener(marker, 'click',function() { // waits for a click, then shows content
					infowindow.setContent(place.name);
					infowindow.open(map,this);

				});
				return marker;
			}

			function clearResults(markers) {
				for (var m in markers){
					markers[m].setMap(null)
				}
				markers = []
			}
			google.maps.event.addDomListener(window,'load',initialize);
			
		</script>

		<style>
		html, body, #map {
			height:100%;
			margin: 0px;
			padding: 0px
		}
		</style>
	</head>
	<body>
		<div id="map">
		</div>
	</body>
	</html>